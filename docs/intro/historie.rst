Historie
========

Das Multifunktionsdisplay OBP60 V2 gibt es jetzt in einer zweiten, neueren Version. Der Grund für die Überarbeitung des voll funktionsfähigen ersten OPB60 liegt in der grundlegenden Änderung des Konzepts. Das ursprüngliche OPB60 basierte auf Erweiterungsmodulen wie einem ESP32, einem E-Paper Display, einem GPS-Modul und Umgebungssensorik. Diese Module mussten mittels durchsteckbarer Stiftleisten auf der Basisplatine eingelötet werden. Im Summe waren das ca. 60 Lötpunkte, die manuell verlötet werden mussten. Die Module sind zum Teil nur einseitig mit Stiftleisten versehen und müssen beim Löten abgestützt werden. Auch das Display muss vorher eingebaut sein, um es verlöten zu können. Für ein Hobbyprojekt mit manueller Bestückung mag das konzeptionell stimmig sein. Für eine Serienfertigung in größeren Stückzahlen ist der alte Ansatz aber sehr zeit- und kostenintensiv und nur mit erheblichem Aufwand realisierbar. Zudem sind die Module nicht in ausreichend gleichbleibender Qualität zu beziehen, und man muss mit großen Qualitätsschwankungen rechnen. Insbesondere beim GPS- und beim BME280-Modul gab es in der Vergangenheit große Probleme mit defekten Modulen. Jedes Modul musste daher vor dem Einbau manuell geprüft werden. Bei Anfragen für eine Fertigung in China ließen sich die Module nicht über große Bauteildistributoren besorgen, die Logistik wäre demzufolge sehr aufwändig geworden. Insgesamt hätte es auch keinen Sinn gemacht, die Platine ohne Module zu verkaufen, da ein Funktionstest der Platine so nicht möglich gewesen wäre.

Zusätzlich hatte sich herausgestellt, dass auch einige Schaltungsteile nicht richtig funktioniert haben. Die Backup-Versorgung über den GoldCap für den Ausschaltvorgang war zu klein dimensioniert. Die Energiemenge reichte nicht aus, um das E-Paper Display beim Aussschalten zu löschen und in einen definierten Zustand zu versetzen. Das wiederum hatte auch Folgeprobleme beim Einschalten des E-Paper Displays. Auch die 3,3V Stromversorgung für das BME280-Modul reichte nicht aus, um das Modul sicher betreiben zu können. Nach einiger Zeit im laufenden Betrieb erhöhte sich die Eigenerwärmung, das Modul fiel aus und kommunizierte nur noch fehlerhaft mit der CPU. Durch die umfangreiche Firmware gab es auch ein Problem mit dem Arbeitsspeicher. Er war in einigen Situationen zu knapp bemessen und verursachte dadurch ungewollte Reboots des OBP60. Am I2C-Bus gab es ebenfalls gelegentlich Probleme, wenn externe Komponenten an den Bus angeschlossen wurden. Im realen Einsatz konnten externe Störungen anderer Baugruppen über den I2C-Bus rückwärts in das OBP60 einkoppeln. Da der selbe I2C-Bus auch andere wichtige Komponenten des OBP60 versorgt, hatte das schwerwiegende Folgen für die Gesamtstabilität des Systems. Mit galvanisch getrennten Bussystemen kann man solche Probleme umgehen. Beim verwendeten GPS-Modul stellte sich heraus, dass die Firmware des Moduls Fehler enthielt. Das Modul sendete in ganz bestimmten Situationen bei schlechtem GPS-Empfang verstümmelte NMEA0183-Telegramme, die aber korrekte Checksummen enthielten. In solchen Situationen konnte das OBP60 komplett einfrieren, da der Parser nicht mit den fehlerhaften Daten umgehen konnte. Inzwischen wurde die Firmware des OBP60 angepasst und der Fehler konnte behoben werden. 

Verständlicherweise war es daher nicht sinnvoll, den OBP60 in der alten Form in größeren Stückzahlen zu produzieren. Das hätte, wie beschrieben, zu viele Probleme verursacht, und man hätte es logistisch und vom Zeitaufwand her nicht umsetzen können.

Aus diesen Gründen wurde die Platine komplett neu entwickelt. Ziel war es, die Platinen so zu gestalten, dass sie überwiegend mit SMD-Bauelementen vollautomatisch bestückt werden können und nur sehr wenige durchsteckbare Bauelemente enthalten. So ist es möglich, dass der Platinenhersteller die Platinen vollständig automatisiert bestücken kann, ohne dass danach noch manuell gelötet werden muss. Damit lassen sich jetzt beliebige Stückzahlen ohne zusätzlichen Aufwand fertigen. Allein die Programmierung und der Test sind dann noch manuelle Abläufe, die man aber auch noch zum Fertiger auslagern kann, wenn man dem Fertiger das zugehörige Test-Equipment zur Verfügung stellt.

Bei der Neuentwicklung wurden auch einige Funktionen weggelassen, die sich als überflüssig heraus gestellt haben. Der SeaTalk-Bus und die Porterweiterung wurden nur ganz selten eingesetzt. Beim BME280 macht es keinen Sinn, die Luftfeuchtigkeit im Inneren des Gerätes zu messen. Zwischenzeitlich gab es massive Beschaffungsprobleme des Bosch-Sensors und der Preis war in eine inakzeptable Höhe geschossen. Der BME280 wurde deshalb durch den BMP280 ersetzt, der nur noch Luftdruck und Temperatur misst. Zudem lässt er sich auch wesentlich besser beschaffen und ist deutlich günstiger. Das GPS-Modul wurde komplett entfernt, alle mit dem GPS-Empfang zusammenhängenden Bauteile werden nun direkt auf der Platine platziert. Dafür werden jetzt qualitativ hochwertige GPS-Chips chinesischer Bauart verwendet, die gut beschaffbar und günstig sind. Bei den Bussystemen wurden der I2C-Bus, der NMEA2000-Bus und der NMEA0183-Bus galvanisch isoliert ausgeführt, um die Einkopplung störender Einflüsse zu reduzieren. Alle drei Busse sind gegen Überspannungen, Verpolung und gegen Überstrom gesichert. Es gibt jetzt auch spezielle Anschlüsse, auf die die Leitungsschirmung aufgelegt werden kann. Diese sind gegen Überspannungen bis 8kV gesichert. Ein isolierender DC/DC-Wandler stellt für den Nutzer eine 5V-Versorgung mit 200 mA bereit, mit der externe Schaltungen potenzialfrei versorgt werden können. Damit lassen sich z.B. mehrere Batterie-Monitore gleichzeitig betreiben oder andere Sensoren einfach anbinden. 

Der Versorgungsspannungseingang wurde ebenfalls gegen Überspannung, Verpolung und gegen Überstrom gesichert. Damit hat man eine ausreichend gute Absicherung auch bei Blitzschlag. Insgesamt sollte die gesamte Schaltung CE-gerecht umgesetzt sein. Das muss aber noch in einem gesonderten Test nachgewiesen werden. Beim 1Wire-Bus wurde auf eine galvanische Isolation verzichtet, da der Bus selbstversorgt ist und keine externe Einspeisung oder Verbindung zu anderen elektrischen Schaltungsteilen benötigt. Mit entsprechender Kabelschirmung ist der 1Wire-Bus ausreichend gesichert.

Die Hintergrundbeleuchtung und die Flash-LED sind jetzt als RGB-LEDs ausgeführt. Damit können die Leuchtfarbe und die Helligkeit für jede LED separat eingestellt werden.

Das E-Paper-Display wurde direkt mit der Hauptplatine verbunden. Dabei schützt eine Trägerplatte das empfindliche Glassubstrat des E-Paper-Displays. Insgesamt ist dadurch der Aufbau kompakter geworden, und die Platine und das Display bilden eine Einheit. Durch die geringere Bautiefe können die Abmaße der originalen Raymarine-ST60-Instrumente wieder eingehalten werden.

Die Programmierung des OBP60 gestaltet sich jetzt auch einfacher. Auf der Platine gibt es einen USB-C-Steckverbinder, über den das Board programmiert werden kann. Durch die Verwendung des neuen ESP32 S3 entfällt auch der USB-Seriell-Umsetzer. Er ist bereits im ESP32 S3 enthalten. Der USB-C-Anschluss ist direkt über die Rückseite des OBP60 erreichbar. Darüber können auch NMEA0183-Daten biddirektional übertragen werden. So lassen sich die Daten zum Beispiel zwischen einem PC oder einem Raspberry Pi austauschen. Sofern der USB-Host, zum Beispiel ein Steckernetzteil, 5.1V mit 500mA liefert, kann  das OBP60 auch damit betrieben werden. Der nun im OPB60 verbaute ESP32 S3 ist aktuell der leistungsfähigste ESP32, den man bekommen kann. Neben einem größeren RAM verfügt der ESP32 S3 auch über PSRAM, womit sich der Arbeitsspeicher noch deutlich erhöhen lässt.
